
== Custom Game Options ==

When you start a new playthrough, you should be able to configure a wide variety of Custom Game options. 
You'll initially be presented with three presets:

 - Enhanced
    = All optional QOL changes are enabled.

 - Vanilla
    = All optional QOL changes are disabled.

 - Nuzlocke
    = All optional QOL changes are enabled, except for any that may make the game easier (e.g. faster 
      overworld running speed, which could help you dodge spinners). The following Nuzlocke settings 
      are also activated:
      
       - Nuzlocke: Enabled
       - Slain Pokemon Behavior: Graveyard
       - Encounter Limit: Enabled
          - Gift Pokemon: Counts as Encounter
          - Shiny Exception: Always Allow
          - Dupes Clause: Enabled
             - Shiny Exception: Always Allow

 - Custom Game
    = Brings you to the full Custom Game options menu, with all options set to their "Enhanced" values; 
      there, you can configure absolutely anything before starting your playthrough.


I want to offer a ton of options, which means a ton of values to store in flash memory. Some basic 
principles:

 - **Data should be bitpacked.** If we don't need a whole byte, then don't use a whole byte. We can read 
   data in and out of RAM and convert between CPU-efficient and storage-efficient formats as needed.
   
 - **Avoid the use of presence bits.** My experience with bitpacked data comes from Halo: Reach, which 
   used "presence bits" for pieces of data that could be conditionally omitted from UGC. However, in our 
   case, we're packing data into a small storage space, and it needs to be possible to store every data 
   field and every combination of data values. As such, we gain nothing from presence bits, and using 
   them will only expose us to potential mistakes wherein we test smaller combinations of data and miss 
   when larger combinations of data can't fit in the allotted space.
   
 - **Data should be versioned.** Data should be prefixed with a 32-bit version number (non-semver). If 
   at all possible, however, I'd like to avoid having an upgrade procedure in the ROM itself, as that'll 
   lead to more and more seldom-used code going forward. Instead, I want to look into the possibility of 
   save data transplantation. Can I write a C++ program that can transplant one savestate's flash memory 
   into a title-screen savestate, and if so, would that even work? If so, then the upgrade procedure 
   becomes "make an in-game save; savestate afterwards; then make a second savestate at the title screen; 
   then run the tool."
   
   Or maybe emulators today have something equivalent enough to render that kind of jank unnecessary? For 
   now, the goal is just to get Custom Games working at all, but I may as well tack a version number onto 
   the data just to prep for *whatever we end up doing* to allow forward-compatibility for savedata after 
   we launch.


=== Value types and storage formats ===

 - Species ID: 11 bits; range [0, 2047]
 - Percentage scale, unsigned, wide:
    - [0, 5000] with  1% granularity would be 13 bits
    - [0, 5000] with 10% granularity would be  9 bits

=== Desired ===

 = Union: starting species
    - Override all three starter Pokemon
       - Cost: 3 uint16_ts
    - Single-species challenge
       - Cost:
          - uint16_t: player species
          - uint16_t: rival base species (we evolve it for later battles)
          - 2-bit enum:
             - Only allow catching target species
             - Polymorph all caught Pokemon into target species
             - Grant instance of target species after each Gym Badge, up to 6
          = Total: 34 bits

 = Scaling
    - Battle values for both player and enemy
       - Accuracy
       - Damage dealt
       - Move side-effect odds
    - Wild encounter rates
    - Catch rates
    - Egg lay time
    - Egg hatch time
    - Mirage Island odds
       = Mirage Island works by testing whether the low 16 bits of any party Pokemon's personality 
         value match the current Mirage Island random value. This means we can scale Mirage Island 
         "odds" in 15 increments at the most granular, not including "never" and "always" options.
    - Money loss on defeat
       - Percentage modifier
       - Clamp to minimum
       - Clamp to maximum
    - Money gain on victory
       - Percentage modifier
       - Clamp to minimum
       - Clamp to maximum
    - Shop prices, buy
    - Shop prices, sell
    - Sprinting speed
    - Overworld poison damage rates
       - Steps taken
       - Damage dealt
 
 = Various
    - Allow editing options after starting the playthrough
       = Disabled by default. Intended for Let's Players and other content creators who may 
         need to adjust things on the fly.
    - Swap trade evolutions for stone or level evolutions
       - Cost: 2-bit enum
          = Disabled
          = Stones
          = Level Ups
    - Enable/disable full Pokedex access
       - Enables alternate encounter tables to avoid version-exclusive species
       - Enables additional events for any exclusive legendaries
       - Enables additional events to allow all fossils and starters
          = Needs to ensure all three vanilla starters are catchable if you override starter species
    - Cap player party size
       - Cost: 3-bit value (party cap; 0 = no cap)
    - Cap player party levels
       - ...to furthest-visited route's max wild level
       - ...to highest level in next Gym Leader's party
          = Uses Rival and Champion once all Leaders are defeated
       - ...to constant
    - Limit catches by type(s)
       - Bitfield for types
    - Override player or enemy types
       = i.e. we always act as if your Pokemon are, say, Fire-type
    - Double Battles
       - 4 options; 2 bits.
       - Normal
          = Acts as "Permissive" if you cap your party size at 1. Needed to 
            avoid getting softlocked at Tate & Liza.
       - Permissive
          = You can enter Double Battles even if you only have one Pokemon.
       - Forced
          = All battles are Double Battles.
       - Disabled
          = All battles are Single Battles.
    - Enable/disable player item use during battles
    - Allow HM use without teaching moves
       - Make Fly configurable separately from the others
       - Allow Fly (i.e. fast travel) from game start
    - Enable/disable limited events (e.g. Eon Ticket)
    - Enable/disable reusable TMs
    - Enable/disable rebattling fainted/fled legendaries
       = Set fallback locations for Lati@s? Or just make it so it never stops roaming until caught?
    - Enable/disable step counter instead of real-time clock for events (e.g. berries, dailies, etc.)
    - Enable/disable infinite Rare Candies
    - Enable/disable infinite stat vitamins

 = Randomizer
    = Different randomizations should be "volatile" or "static." The former means that they're always 
      re-rolled during play: save-scumming produces different results with every reload.
 
 = Nuzlocke
    - Enable/disable
    = Options below are greyed out if the above is Disabled.
    - Slain Pokemon behavior
       - Graveyard boxes (set count)
       - Delete forever
    - Encounter limit options
      // "Control when you're allowed to catch Pokemon."
       - Encounter Limit              // 2-bit enum
          - Disabled
          - One per Location
          - First Encounter or Bust
       = Options below are greyed out if the above is Disabled.
       - Gift Pokemon Behavior        // 2-bit enum
          - Free; Doesn't Count
          - Counts as Encounter
          - Disable All Gifts
       - Shiny Exception              // 1 bit
          - No Exception
          - Replace Prior from Same Route
          - Always Allow
       - Dupes Clause                 // 1 bit
          - Disabled
          - Enabled
       - Dupes Clause Shiny Exception // 2 bits
          - No Exception
          - Replace Prior of Same Species
          - Always Allow
    - Deactivation Condition
       - Never Deactivate
          = ...unless the user left "edit CG options after starting" enabled, in which case they can 
            still switch Nuzlocking off by hand.
       - After Champion
       - After Rayquaza
          = IIRC Rayquaza is post-game, or at least can be.
       - After All Legendaries
          = After you've caught or defeated every legendary at least once.